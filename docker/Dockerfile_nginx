# Stage 1: Get build artifacts from intelowl-ng
ARG INTELOWL_NG_TAG_VERSION="v3.1.0"
FROM intelowlproject/intelowl_ng:${INTELOWL_NG_TAG_VERSION} AS angular-prod-build

# Stage 2: Inject the build artifacts into nginx container
FROM library/nginx:1.23.0-alpine

COPY --from=angular-prod-build /usr/src/app/dist /var/www/angular_build

ENV NGINX_LOG_DIR /var/log/nginx
# this is to avoid having these logs redirected to stdout/stderr
RUN rm $NGINX_LOG_DIR/access.log $NGINX_LOG_DIR/error.log
RUN touch $NGINX_LOG_DIR/access.log $NGINX_LOG_DIR/error.log
VOLUME /var/log/nginx