##
## clamav-milter.conf - automatically generated by clamconf 0.103.3
##

# Comment out or remove the line below.
Example

# Save all reports to a log file.
# Default: disabled
#LogFile /tmp/clamav.log

# By default the log file is locked for writing and only a single
# daemon process can write to it. This option disables the lock.
# Default: no
#LogFileUnlock yes

# Maximum size of the log file.
# Value of 0 disables the limit.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 1048576
#LogFileMaxSize 5M

# Log time with each message.
# Default: no
#LogTime yes

# Use the system logger (can work together with LogFile).
# Default: no
#LogSyslog yes

# Type of syslog messages.
# Please refer to 'man syslog' for the facility names.
# Default: LOG_LOCAL6
#LogFacility LOG_MAIL

# Enable verbose logging.
# Default: no
#LogVerbose yes

# Rotate log file. Requires LogFileMaxSize option set prior to this option.
# Default: no
#LogRotate yes

# Save the process ID to a file.
# Default: disabled
#PidFile /var/run/clam.pid

# This option allows you to change the default temporary directory.
# Default: disabled
#TemporaryDirectory /tmp

# Remove a stale socket after unclean shutdown
# Default: yes
#FixStaleSocket yes

# Maximum number of threads running at the same time.
# Default: 10
#MaxThreads 20

# Waiting for data from clamd will timeout after this time (seconds).
# Default: 120
#ReadTimeout 300

# Don't fork into background.
# Default: no
#Foreground no

# Run the daemon as a specified user (the process must be started by root).
# Default: disabled
#User clamav

# Files/messages larger than this limit won't be scanned. Affects the input
# file itself as well as files contained inside it (when the input file is
# an archive, a document or some other kind of container).
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result in severe
# damage to the system.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 26214400
#MaxFileSize 25M

# Define the clamd socket to connect to for scanning.
# This option is mandatory! Syntax:
#   ClamdSocket unix:path
#   ClamdSocket tcp:host:port
# The first syntax specifies a local unix socket (needs an absolute path) e.g.:
#   ClamdSocket unix:/var/run/clamd/clamd.socket
# The second syntax specifies a tcp local or remote tcp socket: the
# host can be a hostname or an ip address; the ":port" field is only required
# for IPv6 addresses, otherwise it defaults to 3310
#   ClamdSocket tcp:192.168.0.1
# This option can be repeated several times with different sockets or even
# with the same socket: clamd servers will be selected in a round-robin fashion.
# Default: disabled
#ClamdSocket tcp:scanner.mydomain:7357

# Define the interface through which we communicate with sendmail.
# This option is mandatory! Possible formats are:
# [[unix|local]:]/path/to/file - to specify a unix domain socket;
# inet:port@[hostname|ip-address] - to specify an ipv4 socket;
# inet6:port@[hostname|ip-address] - to specify an ipv6 socket.
# Default: disabled
#MilterSocket /tmp/clamav-milter.socket
#MilterSocket inet:7357

# Define the group ownership for the (unix) milter socket.
# Default: disabled
#MilterSocketGroup virusgroup

# Sets the permissions on the (unix) milter socket to the specified mode.
# Default: disabled
#MilterSocketMode 660

# Messages originating from these hosts/networks will not be scanned
# This option takes a host(name)/mask pair in CIRD notation and can be
# repeated several times. If "/mask" is omitted, a host is assumed.
# To specify a locally originated, non-smtp, email use the keyword "local".
# Default: disabled
#LocalNet local
#LocalNet 192.168.0.0/24
#LocalNet 1111:2222:3333::/48

# Action to be performed on clean messages (mostly useful for testing).
# The following actions are available:
# Accept: the message is accepted for delivery
# Reject: immediately refuse delivery (a 5xx error is returned to the peer)
# Defer: return a temporary failure message (4xx) to the peer
# Blackhole: like Accept but the message is sent to oblivion
# Quarantine: like Accept but message is quarantined instead of being delivered
# Default: Accept
#OnClean Accept

# Action to be performed on clean messages (mostly useful for testing).
# The following actions are available:
# Accept: the message is accepted for delivery
# Reject: immediately refuse delivery (a 5xx error is returned to the peer)
# Defer: return a temporary failure message (4xx) to the peer
# Blackhole: like Accept but the message is sent to oblivion
# Quarantine: like Accept but message is quarantined instead of being delivered
# Default: Quarantine
#OnInfected Quarantine

# Action to be performed on error conditions (this includes failure to
# allocate data structures, no scanners available, network timeouts, unknown
# scanner replies and the like.
# The following actions are available:
# Accept: the message is accepted for delivery;
# Reject: immediately refuse delivery (a 5xx error is returned to the peer);
# Defer: return a temporary failure message (4xx) to the peer.
# Default: Defer
#OnFail Defer

# This option allows you to set a specific rejection reason for infected messages
# and it's therefore only useful together with "OnInfected Reject"
# The string "%v", if present, will be replaced with the virus name.
# Default: disabled
#RejectMsg MTA specific

# If this option is set to "Replace" (or "Yes"), an "X-Virus-Scanned" and an
# "X-Virus-Status" headers will be attached to each processed message, possibly
# replacing existing headers.
# If it is set to Add, the X-Virus headers are added possibly on top of the
# existing ones.
# Note that while "Replace" can potentially break DKIM signatures, "Add" may
# confuse procmail and similar filters.
# Default: no
#AddHeader Replace

# When AddHeader is in use, this option allows you to set the reported
# hostname. This may be desirable in order to avoid leaking internal names.
# If unset the real machine name is used.
# Default: disabled
#ReportHostname my.mail.server.name

# Execute a command when an infected message is processed.
# The following parameters are passed to the invoked program in this order:
# virus name, queue id, sender, destination, subject, message id, message date.
# Note #1: this requires MTA macroes to be available (see LogInfected below)
# Note #2: the process is invoked in the context of clamav-milter
# Note #3: clamav-milter will wait for the process to exit. Be quick or fork to
# avoid unnecessary delays in email delivery
# Default: disabled
#VirusAction /usr/local/bin/my_infected_message_handler

# Chroot to the specified directory.
# Chrooting is performed just after reading the config file and before
# dropping privileges.
# Default: disabled
#Chroot /newroot

# This option specifies a file which contains a list of basic POSIX regular
# expressions. Addresses (sent to or from - see below) matching these regexes
# will not be scanned.  Optionally each line can start with the string "From:"
# or "To:" (note: no whitespace after the colon) indicating if it is,
# respectively, the sender or recipient that is to be whitelisted.
# If the field is missing, "To:" is assumed.
# Lines starting with #, : or ! are ignored.
# Default: disabled
#Whitelist /etc/whitelisted_addresses

# Messages from authenticated SMTP users matching this extended POSIX
# regular expression (egrep-like) will not be scanned.
# As an alternative, a file containing a plain (not regex) list of names (one
# per line) can be specified using the prefix "file:".
# e.g. SkipAuthenticated file:/etc/good_guys
# 
# Note: this is the AUTH login name!
# Default: disabled
#SkipAuthenticated SkipAuthenticated ^(tom|dick|henry)$

# This option allows you to tune what is logged when a message is infected.
# Possible values are Off (the default - nothing is logged),
# Basic (minimal info logged), Full (verbose info logged)
# Note:
# For this to work properly in sendmail, make sure the msg_id, mail_addr,
# rcpt_addr and i macroes are available in eom. In other words add a line like:
# Milter.macros.eom={msg_id}, {mail_addr}, {rcpt_addr}, i
# to your .cf file. Alternatively use the macro:
# define(`confMILTER_MACROS_EOM', `{msg_id}, {mail_addr}, {rcpt_addr}, i')
# Postfix should be working fine with the default settings.
# Default: disabled
#LogInfected Basic

# This option allows you to tune what is logged when no threat is found in a scanned message.
# See LogInfected for possible values and caveats.
# Useful in debugging but drastically increases the log size.
# Default: disabled
#LogClean Basic

# This option affects the behaviour of LogInfected, LogClean and VirusAction
# when a message with multiple recipients is scanned:
# If SupportMultipleRecipients is off (the default)
# then one single log entry is generated for the message and, in case the
# message is determined to be malicious, the command indicated by VirusAction
# is executed just once. In both cases only the last recipient is reported.
# If SupportMultipleRecipients is on:
# then one line is logged for each recipient and the command indicated
# by VirusAction is also executed once for each recipient.
# 
# Note: although it's probably a good idea to enable this option, the default value
# is currently set to off for legacy reasons.
# Default: no
#SupportMultipleRecipients yes
